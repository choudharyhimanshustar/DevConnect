{"version":3,"file":"normalize.mjs","sources":["../../../src/slate/plugins/normalize.ts"],"sourcesContent":["import type { Editor } from \"slate\";\nimport { Element, Node, Transforms } from \"slate\";\n\nexport function withNormalize(editor: Editor) {\n  const { normalizeNode } = editor;\n\n  editor.normalizeNode = (entry) => {\n    const [node, path] = entry;\n\n    // Paragraphs should only contain inline elements\n    if (Element.isElement(node) && node.type === \"paragraph\") {\n      for (const [child, childPath] of Node.children(editor, path)) {\n        if (Element.isElement(child) && !editor.isInline(child)) {\n          Transforms.unwrapNodes(editor, { at: childPath });\n          return;\n        }\n      }\n    }\n\n    // Links cannot be nested or empty\n    if (\n      Element.isElement(node) &&\n      (node.type === \"auto-link\" || node.type === \"custom-link\")\n    ) {\n      if (\n        node.children.length === 0 ||\n        (node.children.length === 1 && node.children[0]?.text === \"\")\n      ) {\n        Transforms.removeNodes(editor, { at: path });\n      }\n    }\n\n    normalizeNode(entry);\n  };\n\n  return editor;\n}\n"],"names":[],"mappings":";;AAGO,SAAS,cAAc,MAAgB,EAAA;AAC5C,EAAM,MAAA,EAAE,eAAkB,GAAA,MAAA,CAAA;AAE1B,EAAO,MAAA,CAAA,aAAA,GAAgB,CAAC,KAAU,KAAA;AAChC,IAAM,MAAA,CAAC,IAAM,EAAA,IAAI,CAAI,GAAA,KAAA,CAAA;AAGrB,IAAA,IAAI,QAAQ,SAAU,CAAA,IAAI,CAAK,IAAA,IAAA,CAAK,SAAS,WAAa,EAAA;AACxD,MAAW,KAAA,MAAA,CAAC,OAAO,SAAS,CAAA,IAAK,KAAK,QAAS,CAAA,MAAA,EAAQ,IAAI,CAAG,EAAA;AAC5D,QAAI,IAAA,OAAA,CAAQ,UAAU,KAAK,CAAA,IAAK,CAAC,MAAO,CAAA,QAAA,CAAS,KAAK,CAAG,EAAA;AACvD,UAAA,UAAA,CAAW,WAAY,CAAA,MAAA,EAAQ,EAAE,EAAA,EAAI,WAAW,CAAA,CAAA;AAChD,UAAA,OAAA;AAAA,SACF;AAAA,OACF;AAAA,KACF;AAGA,IACE,IAAA,OAAA,CAAQ,UAAU,IAAI,CAAA,KACrB,KAAK,IAAS,KAAA,WAAA,IAAe,IAAK,CAAA,IAAA,KAAS,aAC5C,CAAA,EAAA;AACA,MAAA,IACE,IAAK,CAAA,QAAA,CAAS,MAAW,KAAA,CAAA,IACxB,IAAK,CAAA,QAAA,CAAS,MAAW,KAAA,CAAA,IAAK,IAAK,CAAA,QAAA,CAAS,CAAI,CAAA,EAAA,IAAA,KAAS,EAC1D,EAAA;AACA,QAAA,UAAA,CAAW,WAAY,CAAA,MAAA,EAAQ,EAAE,EAAA,EAAI,MAAM,CAAA,CAAA;AAAA,OAC7C;AAAA,KACF;AAEA,IAAA,aAAA,CAAc,KAAK,CAAA,CAAA;AAAA,GACrB,CAAA;AAEA,EAAO,OAAA,MAAA,CAAA;AACT;;;;"}